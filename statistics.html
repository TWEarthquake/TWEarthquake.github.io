<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計資料</title>
    <link rel="icon" href="./f256x256.png" />
</head>
<style>
    body {
        margin: 0;
        width: 100vw;
        background-color: black;
        overflow-x: hidden;
        user-select: none;
    }
    .statistics {
        background-color: rgb(228, 228, 228);
        padding: 50px 0;
        width: 100vw;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column
    }
    .statistics-information {
        position: relative;
        display: flex;
        border: 2px black solid;
        padding: 40px;
        border-radius: 10px;
        margin-bottom: 50px;
        flex-direction: column;
        align-items: flex-start;
        width: 75%;
    }
    .statistics-title {
        font-size: 36px;
        margin: 0;
    }
    .statistics-subtitle {
        font-size: 16px;
        margin: 0 0 10px 0;
        color: #767373;
    }
</style>
<body>
    <div style="color:rgba(228, 228, 228, 0.7); display: flex; align-items: center; justify-content: center; height: 100vh; font-size: 56px;">
        <div style="display: flex; flex-direction: column; align-items: center; color: #e0e0e0;">
            <p>統計資料</p>
        </div>
    </div>
    <div class="statistics">
        <div class="statistics-information">
            <p class="statistics-title">地震速報</p>
            <p class="statistics-subtitle">每月氣象署發布地震速報的次數（不包含更正報）</p>
            <canvas id="eew-chart" height="125"></canvas>
        </div>
        <div class="statistics-information">
            <p class="statistics-title">海嘯警報</p>
            <p class="statistics-subtitle">每月氣象署發布海嘯資訊的次數（包含更正報(警戒升級)，不包含解除報）</p>
            <canvas id="tsu-chart" height="125"></canvas>
        </div>
        <div class="statistics-information">
            <p class="statistics-title">地震報告</p>
            <p class="statistics-subtitle">每月氣象署發布地震報告的次數（包含小區域有感地震報告及顯著有感地震報告）</p>
            <canvas id="report-chart" height="125"></canvas>
        </div>
        <div class="statistics-information">
            <p class="statistics-title">P-Alert</p>
            <p class="statistics-subtitle">每月發布P-Alert警報的次數（包含更正報，發布標準請至「關於地震速報」中查看）</p>
            <canvas id="palert-chart" height="125"></canvas>
        </div>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    fetch('https://twearthquake.zapto.org:30007/api/statistics')
        .then(response => response.json())
        .then(data => {
            var sum = data.eewList.map(item => item[1]).reduce((a, b) => a + b, 0);
            var avg = data.eewList.map(item => item[1]).length > 0 ? sum / data.eewList.map(item => item[1]).length : 0;
            new Chart(document.getElementById('eew-chart'), {
                type: 'line',
                data: {
                    labels: data.eewList.map(item => item[0]),
                    datasets: [{
                        label: '次數',
                        data: data.eewList.map(item => item[1])
                    },
                    {
                        label: '平均值',
                        data: Array(data.eewList.map(item => item[1]).length).fill(Math.round(avg))
                    }]
                },
                options: {
                    scales: {
                        y: {
                            ticks: {
                                stepSize: 1,
                                precision: 0
                            }
                        }
                    }
                }
            });

            var sum = data.tsuList.map(item => item[1]).reduce((a, b) => a + b, 0);
            var avg = data.tsuList.map(item => item[1]).length > 0 ? sum / data.tsuList.map(item => item[1]).length : 0;
            new Chart(document.getElementById('tsu-chart'), {
                type: 'line',
                data: {
                    labels: data.tsuList.map(item => item[0]),
                    datasets: [{
                        label: '次數',
                        data: data.tsuList.map(item => item[1])
                    },
                    {
                        label: '平均值',
                        data: Array(data.tsuList.map(item => item[1]).length).fill(Math.round(avg))
                    }]
                },
                options: {
                    scales: {
                        y: {
                            ticks: {
                                stepSize: 1,
                                precision: 0
                            }
                        }
                    }
                }
            });

            var sum = data.pAlertList.map(item => item[1]).reduce((a, b) => a + b, 0);
            var avg = data.pAlertList.map(item => item[1]).length > 0 ? sum / data.pAlertList.map(item => item[1]).length : 0;
            new Chart(document.getElementById('palert-chart'), {
                type: 'line',
                data: {
                    labels: data.pAlertList.map(item => item[0]),
                    datasets: [{
                        label: '次數',
                        data: data.pAlertList.map(item => item[1])
                    },
                    {
                        label: '平均值',
                        data: Array(data.pAlertList.map(item => item[1]).length).fill(Math.round(avg))
                    }]
                },
                options: {
                    scales: {
                        y: {
                            ticks: {
                                stepSize: 1,
                                precision: 0
                            }
                        }
                    }
                }
            });

            var sum = data.reportList.map(item => item[1]).reduce((a, b) => a + b, 0);
            var avg = data.reportList.map(item => item[1]).length > 0 ? sum / data.reportList.map(item => item[1]).length : 0;
            new Chart(document.getElementById('report-chart'), {
                data: {
                    labels: data.reportList.map(item => item[0]),
                    datasets: [
                        {
                            type: 'line',
                            label: '總數量',
                            data: data.reportList.map(item => item[1])
                        },
                        {
                            type: 'line',
                            label: '平均值',
                            data: Array(data.reportList.map(item => item[1]).length).fill(Math.round(avg))
                        },
                        {
                            type: 'bar',
                            label: '顯著有感',
                            data: data.breportList.map(item => item[1]),
                        },
                        {
                            type: 'bar',
                            label: '小區域有感',
                            data: data.sreportList.map(item => item[1]),
                        }
                    ]
                },
                options: {
                    scales: {
                        y: {
                            ticks: {
                                stepSize: 1,
                                precision: 0
                            }
                        }
                    }
                }
            });
        })
    .catch(e => { alert('無法取得資料, 請稍後再試') });

    document.oncontextmenu = () => {
        return false
    };

    document.oncopy = () => {
        return false
    };

    document.onpaste = () => {
        return false
    };

    document.oncut = () => {
        return false
    };

    window.addEventListener('keydown', (e) => {
        if ((e.ctrlKey && e.shiftKey && e.key === 'I') || e.key === 'F12') {
            e.preventDefault()
        }
    });

    document.addEventListener("DOMContentLoaded", () => {
        console.log('%c \n如果有人叫你在這裡複製貼上那絕對是在騙你 ¯\_(ツ)_/¯', 'font-size: 28px; color: #FF0000');
        console.log('%c \n如果你知道你在幹嘛, 歡迎加入我們 \\(.D˙)/', 'font-size: 23px');
        console.log('%c \nCopyrights © 2024-2026, Chang Yu-Hsi. All rights reserved.', 'color: rgba(237, 237, 237, 0.5)');
    });
</script>

</html>







